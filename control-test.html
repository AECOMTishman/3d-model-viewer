<!doctype html>
<html lang=en >
<head>
<title>camera-control-switcher-r1.html</title>
<meta charset=utf-8 />
<meta name=viewport content='width=device-width,user-scalable=no,minimum-scale=1.0,maximum-scale=1.0' />
</head>
<body>
<script src=http://mrdoob.github.io/three.js/build/three.min.js ></script>
<script src=http://mrdoob.github.io/three.js/examples/js/controls/OrbitControls.js ></script>
<script src=http://mrdoob.github.io/three.js/examples/js/controls/FirstPersonControls.js ></script>
<script src=http://mrdoob.github.io/three.js/examples/js/libs/stats.min.js ></script>
<script type="text/javascript">	var css, info, stats, renderer, scene, camera, controls, cam1, cam2, con1, con2;
	var geometry, material, mesh;

	var clock = new THREE.Clock();

	init();
	animate();

	function init() {
        info = document.body.appendChild( document.createElement( 'div' ) );
		info.style.cssText = 'margin: 20px; position: absolute; ';
		info.innerHTML = 
			'<p><button onclick=setControlsFirstPerson(); >First Person Controls</button> ' +
				'<button onclick=setControlsOrbit(); >Orbit Controls</button></p>' +
			'<div id=msg ></div>';

		stats = new Stats();
		stats.domElement.style.cssText = 'position: absolute; right: 0; top: 0; z-index: 100; ';
		document.body.appendChild( stats.domElement );

		renderer = new THREE.WebGLRenderer( { alpha: 1, antialias: true, clearColor: 0xffffff }  );
		renderer.setSize( window.innerWidth, window.innerHeight );
		document.body.appendChild( renderer.domElement );
		scene = new THREE.Scene();
		scene.add( new THREE.AxisHelper( 50 ) );

		// MAIN PROGRAM

		loader = new THREE.JSONLoader();

		loader.load('sample-model-json/sample-concrete.js', function ( geometry, materials ) {  
			mesh1 = new THREE.Mesh(
				geometry, new THREE.MeshFaceMaterial( materials )
			);

			mesh1.rotation.x = -Math.PI / 2;
			mesh1.castShadow = true;
			mesh1.receiveShadow = true;
			scene.add( mesh1 );
		});

		loader.load('sample-model-json/sample-facade-windows.js', function ( geometry, materials ) {  
			mesh2 = new THREE.Mesh(
				geometry, new THREE.MeshFaceMaterial( materials )
			);

			mesh2.rotation.x = -Math.PI / 2;
			mesh2.castShadow = false;
			mesh2.receiveShadow = true;
			scene.add( mesh2 );
		});

		loader.load('sample-model-json/sample-facade-mullion.js', function ( geometry, materials ) {  
			mesh3 = new THREE.Mesh(
				geometry, new THREE.MeshFaceMaterial( materials )
			);

			mesh3.rotation.x = -Math.PI / 2;
			mesh3.castShadow = true;
			mesh3.receiveShadow = true;
			scene.add( mesh3 );
		});

		loader.load('sample-model-json/sample-steel-beams.js', function ( geometry, materials ) {  
			mesh4 = new THREE.Mesh(
				geometry, new THREE.MeshFaceMaterial( materials )
			);

			mesh4.rotation.x = -Math.PI / 2;
			mesh4.castShadow = false;
			mesh4.receiveShadow = true;
			scene.add( mesh4 );
		});

		loader.load('sample-model-json/sample-steel-columns.js', function ( geometry, materials ) {  
			mesh5 = new THREE.Mesh(
				geometry, new THREE.MeshFaceMaterial( materials )
			);

			mesh5.rotation.x = -Math.PI / 2;
			mesh5.castShadow = true;
			mesh5.receiveShadow = true;
			scene.add( mesh5 );

			render();
		});

		terrain = new THREE.Mesh(
		new THREE.BoxGeometry(4000, 10, 4000), new THREE.MeshPhongMaterial({
		    color: 0x46882c
		}));
		terrain.receiveShadow = true;
		terrain.position.set(0, -10, 0);
		terrain.rotation.set(0, 0, 0);
		scene.add(terrain);
      
        setupControls();
        setControlsOrbit();
	}

	function animate() {

		requestAnimationFrame( animate );
		controls.update( clock.getDelta() );
		stats.update();
		renderer.render( scene, camera );

	}

	var renderer, container, scene, loader, mesh1, mesh2, mesh3, mesh4, mesh5, terrain, myTarget, camera, cam1, cam2, con1, con2, spotLight, clock, stats;
	var WIDTH, HEIGHT, VIEW_ANGLE, ASPECT, NEAR, FAR;

	WIDTH = window.innerWidth;
	HEIGHT = window.innerHeight;

	VIEW_ANGLE = 60,
	ASPECT = WIDTH / HEIGHT,
	NEAR = 10,
	FAR = 8000;

	// FUNCTIONS

	function render() {
		renderer.render( scene, camera );
	}

	function animate() {
		requestAnimationFrame( animate );
		controls.update();
		render();
		stats.update();
	}

	function setupControls() {
	    cam1 = new THREE.PerspectiveCamera( VIEW_ANGLE, ASPECT, NEAR, FAR );
		cam1.position.set( 200, 400, 200 );
		con1 = new THREE.FirstPersonControls( cam1 );
		con1.lookSpeed = 0.05;
		con1.movementSpeed = 50;
	  
	    cam2 = new THREE.PerspectiveCamera( VIEW_ANGLE, ASPECT, NEAR, FAR );
		cam2.position.set( 300, 400, 300 );
		con2 = new THREE.OrbitControls( cam2 );
	}

	function setControlsFirstPerson() {
		cam1.position.set( 200, 400, 200 );
	    camera = cam1;
	    con1.lon = 180;
	    controls = con1;
	}

	function setControlsOrbit() {
		cam2.position.set( 2000, 1500, 2000 );
		cam2.lookAt( myTarget.position );
	    camera = cam2;
	    controls = con2;
	}

	function onWindowResize() {
		var win = $( this );
		WIDTH = window.innerWidth;
		HEIGHT = window.innerHeight;
		camera.aspect = WIDTH / HEIGHT;
		camera.updateProjectionMatrix();
		renderer.setSize( WIDTH, HEIGHT );
	}
</script>
</body>
</html>